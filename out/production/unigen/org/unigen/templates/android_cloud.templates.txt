file_name ~{name}.java~

file_header
~
//
//    THIS FILE WAS GENERATED WITH "UNIGEN"
//    DO NOT EDIT CODE MANUALLY
//
//    Source: {source}
//    Time: {time}
//



~

api_interface_location ~interface/cloud~
api_implementation_location ~implementation~

api_types_class_header ~
public class {name} {
~

api_type_class_header ~
	public class {name} {
~

api_type_field ~
	public {type} {name};
~
api_type_factory_method ~
	public {name} create{name}() { return new {name}(); }
~

api_type_converter_header ~
    "\tpublic CloudApiStructConverter<{type}> {name} = new CloudApiStructConverter<>(\n" +
    "\t\tnew CloudApiStructConverter.ObjectFactory<{type}>() {\n" +
    "\t\t\tpublic {type} apply() {\n" +
    "\t\t\t\treturn new {type}();\n" +
    "\t\t\t}\n" +
    "\t\t},\n" +
    "\t\tnew CloudApiStructConverter.ArrayFactory<{type}>() {\n" +
    "\t\t\tpublic {type}[] apply(int size) {\n" +
    "\t\t\t\treturn new {type}[size];\n" +
    "\t\t\t}\n" +
    "\t\t},\n";
~

api_type_converter_field ~"\t\tnew CloudApiFieldConverter<>({quoted_name}, {quoted_record_schema_name}, \n" +
    "\t\t\tnew CloudApiFieldConverter.FieldSetter<{type}>() { public void convert({type} target, Object jsonValue) throws Exception { target.{name} = {from_json}(jsonValue); } },\n" +
    "\t\t\tnew CloudApiFieldConverter.FieldGetter<{type}>() { public Object convert({type} source) throws Exception { return {to_json}(source.{name}); } }\n" +
    "\t\t){separator}\n";
~

api_type_converter_footer ~= "\t);\n";~
api_type_class_footer ~= "\t}\n";~

api_types_class_footer ~
}
~

api_interface_header ~= "public interface {name} {\n";~
api_interface_method_params_result ~= "\t{result} {name}({params}) throws Exception;\n";~
api_interface_method_params ~= "\tvoid {name}({params}) throws Exception;\n";~
api_interface_method_result ~= "\t{result} {name}() throws Exception;\n";~
api_interface_method ~= "\tvoid {name}() throws Exception;\n";~
api_interface_footer ~= "}\n";~


api_implementation_class_header ~= "" +
    "package {package};\n" +
    "import org.json.JSONObject;\n" +
    "import ru.tensor.uni.cloud.*;\n" +
    "import java.util.UUID;\n" +
    "import java.util.Date;\n" +
    "public class {class} implements {interface}, Component {\n" +
    "\tprivate CloudConnector cloudConnector;\n" +
    "\tpublic void resolveDependency(DependencyResolvers dependency) {\n" +
    "\t\tthis.cloudConnector = dependency.required(CloudConnector.class);\n" +
    "\t}\n";~


api_implementation_method_parameter_declaration ~= "{type} {name}";~
api_implementation_method_params_result_header ~= "\tpublic {result} {name}({params}) throws Exception {\n";~
api_implementation_method_params_header ~= "\tpublic void {name}({params}) throws Exception {\n";~
api_implementation_method_result_header ~= "\tpublic {result} {name}() throws Exception {\n";~
api_implementation_method_header ~= "\tpublic void {name}() throws Exception {\n";~
api_implementation_method_params_var_declaration ~= "\t\t{type} {var} = {creation};\n";~
api_implementation_method_params_field_assignment ~= "\t\t{var}.{field} = {field};\n";~

api_implementation_method_invoke_params_result ~= "" +
    "\t\treturn {result_converter}(\n" +
    "\t\t\tcloudConnector.invokeService(cloudConnector.makeUrl({quoted_url}), {protocol}, {quoted_method},\n" +
    "\t\t\t\t{params_converter}({params})));\n";
~
api_implementation_method_invoke_params ~= "" +
    "\t\tcloudConnector.invokeService(cloudConnector.makeUrl({quoted_url}), {protocol}, {quoted_method},\n" +
    "\t\t\t{params_converter}({params})));\n";
~
api_implementation_method_invoke_result ~= "" +
    "\t\treturn {result_converter}(\n" +
    "\t\t\tcloudConnector.invokeService(cloudConnector.makeUrl({quoted_url}), {protocol}, {quoted_method}, new JSONObject()));\n";
~

api_implementation_method_invoke ~= "" +
    "\t\tcloudConnector.invokeService(cloudConnector.makeUrl({quoted_url}), {protocol}, {quoted_method}, new JSONObject());\n";
~

api_implementation_method_footer ~= "\t}\n";~

api_implementation_class_footer ~= "}";~


